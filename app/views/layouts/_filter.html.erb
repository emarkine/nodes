<% ylist = 2000.upto(Time.now.year)
   qlist = 1.upto(4).collect do |q|
       ["#{q} quarter", q]
   end
   mlist = 1.upto(12).collect do |m|
       date = Time.parse("2000-#{m}-01")
       [date.strftime("%B"), date.month]
   end
%>

<% form_tag "/filter", :id => "filter" do %>
    <%= hidden_field_tag :url,  request.request_uri %>
    <%= select_tag :year, "<option />" + options_for_select(ylist, session[:year]) %>
    <% if session[:year] == 0 %>
        <%= select_tag :quarter, "<option />" + options_for_select(qlist, session[:quarter]), :disabled => true %>
        <%= select_tag :month, "<option />" + options_for_select(mlist, session[:month]), :disabled => true %>
    <% else %>
        <% if session[:month] == 0 %>
            <%= select_tag :quarter, "<option />" + options_for_select(qlist, session[:quarter]) %>
        <% else %>
            <%= select_tag :quarter, "<option />" + options_for_select(qlist, session[:quarter]), :disabled => true %>
        <% end %>
        <% if session[:quarter] == 0 %>
            <%= select_tag :month, "<option />" + options_for_select(mlist, session[:month]) %>
        <% else %>
            <%= select_tag :month, "<option />" + options_for_select(mlist, session[:month]), :disabled => true %>
        <% end %>
    <% end %>
<% end %>